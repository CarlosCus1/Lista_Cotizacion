import{u as qe,c as He,t as $,j as e,f as Ge,a as b}from"./index-eb78f2c6.js";import{r as c}from"./vendor-b1791c80.js";import{u as C,w as Ue}from"./utils-6c4e335f.js";const z=.18;function Ze({onBack:be,catalogData:J=[],descOcultos:oe=[]}){const[u,fe]=c.useState({ruc:"",nombre:"",oc:""}),ve=t=>{const a=t.replace(/\D/g,"");return a.length===11||a.length===8},je=t=>/^\d*$/.test(t),le=u.ruc===""||ve(u.ruc),re=u.oc===""||je(u.oc),[k,D]=c.useState([]),[ne,ye]=c.useState(""),[A,Ne]=c.useState("TODAS"),[Se,L]=c.useState(!1),[ce,T]=c.useState(null),[x,we]=c.useState("codigo"),[g,ie]=c.useState("asc"),[E,q]=c.useState(1),[H,Ce]=c.useState(50),[h,De]=c.useState("orden"),[f,de]=c.useState("asc"),[G,U]=c.useState(1),[B,Ie]=c.useState(50);c.useEffect(()=>{const t=localStorage.getItem("cotizacion_seleccion");if(t)try{const{items:a,timestamp:s}=JSON.parse(t),o=24*60*60*1e3;Date.now()-s<o&&(D(a),L(!0),T(new Date(s)))}catch(a){console.warn("Error loading saved selection:",a)}},[]),c.useEffect(()=>{if(k.length>0){const t={items:k,timestamp:Date.now()};localStorage.setItem("cotizacion_seleccion",JSON.stringify(t)),L(!0),T(new Date)}else localStorage.removeItem("cotizacion_seleccion"),L(!1),T(null)},[k]);const Q=qe(ne,300),xe=c.useMemo(()=>{let t=J;if(A!=="TODAS"&&(t=t.filter(s=>s.linea===A)),Q.trim()){const s=Q.trim().toLowerCase();t=t.filter(o=>String(o.codigo).toLowerCase().includes(s)||String(o.nombre).toLowerCase().includes(s))}return[...t].sort((s,o)=>{let r=0;return h==="orden"?r=(s.orden||999999)-(o.orden||999999):h==="codigo"?r=String(s.codigo).localeCompare(String(o.codigo),void 0,{numeric:!0,sensitivity:"base"}):h==="nombre"?r=String(s.nombre).localeCompare(String(o.nombre),void 0,{sensitivity:"base"}):h==="stock"?r=(s.stock||0)-(o.stock||0):h==="precio_lista"?r=s.precio_lista-o.precio_lista:h==="precio_igv"&&(r=s.precio_lista*(1+z)-o.precio_lista*(1+z)),f==="asc"?r:-r})},[J,A,Q,h,f]),ue=xe.length,Y=Math.ceil(ue/B),me=(G-1)*B,ze=me+B,he=xe.slice(me,ze),m=c.useMemo(()=>{let t=k.map(a=>{const s={...a.product,descManual1:a.manualDiscounts[0]||0,descManual2:a.manualDiscounts[1]||0},{neto:o,priceAfterHiddenDiscounts:r,effectiveHiddenDiscount:p,effectiveProductDiscount:y}=He(s,oe),N=o,_=$(a.quantity*o),M=$(_*(1+z));return{...a.product,quantity:a.quantity,manualDiscounts:a.manualDiscounts,descSuma01:p,descSuma02:y,precioDescSuma01:r,unitPrice:N,totalSinIgv:_,totalConIgv:M}});return t.sort((a,s)=>{let o=0;return x==="codigo"?o=String(a.codigo).localeCompare(String(s.codigo),void 0,{numeric:!0,sensitivity:"base"}):x==="nombre"?o=String(a.nombre).localeCompare(String(s.nombre),void 0,{sensitivity:"base"}):x==="cantidad"?o=a.quantity-s.quantity:x==="precio_base"?o=a.precio_lista-s.precio_lista:x==="precio_unitario"?o=a.unitPrice-s.unitPrice:x==="subtotal"?o=parseFloat(a.totalSinIgv)-parseFloat(s.totalSinIgv):x==="total"&&(o=parseFloat(a.totalConIgv)-parseFloat(s.totalConIgv)),g==="asc"?o:-o}),t},[k,oe,x,g]),ke=m.length,X=Math.ceil(ke/H),ge=(E-1)*H,Pe=ge+H,_e=m.slice(ge,Pe),O=c.useMemo(()=>{const t=m.reduce((o,r)=>o+r.totalSinIgv,0),a=$(t),s=$(a*(1+z));return{subtotal:$(t),totalSinIgv:a,totalConIgv:s}},[m]),pe=t=>{D(a=>a.some(o=>o.product.idx===t.idx)?a.filter(o=>o.product.idx!==t.idx):[...a,{product:t,quantity:1,manualDiscounts:[0,0]}])},Me=(t,a,s)=>{D(o=>o.map(r=>{if(r.product.idx===t){const p={...r};if(a==="quantity")p.quantity=Math.max(1,parseInt(s,10)||1);else if(a.startsWith("manualDiscount")){const y=parseInt(a.replace("manualDiscount",""),10),N=[...p.manualDiscounts];N[y]=Math.max(0,parseFloat(s)||0),p.manualDiscounts=N}return p}return r}))},ee=(t,a)=>{let s=a;t==="ruc"?(s=a.replace(/\D/g,""),s.length>11&&(s=s.slice(0,11))):t==="oc"&&(s=a.replace(/\D/g,"")),fe(o=>({...o,[t]:s}))},j=t=>{x===t?ie(g==="asc"?"desc":"asc"):(we(t),ie("asc")),q(1)},P=t=>{h===t?de(f==="asc"?"desc":"asc"):(De(t),de("asc")),U(1)},Ve=()=>{if(!m.length)return;const t=C.book_new(),a=[["COTIZACIÓN"],[`Cliente: ${u.nombre||"No especificado"}`],[`RUC: ${u.ruc||"No especificado"}`,`OC: ${u.oc||"No especificado"}`],[`Fecha: ${new Date().toLocaleDateString("es-PE")}`],[]],s=["Código","Nombre","Cantidad","Precio Lista"],o=m.map(l=>[l.codigo,l.nombre,l.quantity,l.precio_lista]),r=[];for(let l=1;l<=4;l++)m.some(i=>(i[`desc${l}`]||0)>0)&&r.push({key:`desc${l}`,header:`Desc. Fijo ${l} (%)`,dataIndex:s.length+r.length});for(let l=1;l<=3;l++)m.some(i=>(i[`descManual${l}`]||0)>0)&&r.push({key:`descManual${l}`,header:`Desc. Adic. ${l} (%)`,dataIndex:s.length+r.length});r.forEach(l=>{s.push(l.header)}),o.forEach((l,n)=>{r.forEach(i=>{const d=m[n][i.key]||0;l.push(Math.round(d*100)/100)})}),s.push("Desc. Cliente (%)","Desc. Producto (%)","Precio Unitario","Subtotal","Total c/IGV"),o.forEach((l,n)=>{const i=m[n];l.push(i.descSuma01?Math.round(i.descSuma01*100)/100:0,i.descSuma02?Math.round(i.descSuma02*100)/100:0,i.unitPrice,i.totalSinIgv,i.totalConIgv)});const p=[],y=[],N=[],_=[{wch:12},{wch:40},{wch:10},{wch:14},...r.map(()=>({wch:16})),{wch:16},{wch:16},{wch:16},{wch:14},{wch:14}],M=[];s.forEach((l,n)=>{["Código","Nombre","Cantidad","Precio Unitario","Subtotal","Total c/IGV"].includes(l)?(p.push(n),y.push(l),M.push(_[n])):o.every(v=>v[n]===0||v[n]==="0"||v[n]===null||v[n]===void 0)||(p.push(n),y.push(l),M.push(_[n]))}),o.forEach(l=>{const n=p.map(i=>l[i]);N.push(n)});const K=y,te=N,se=["TOTALES"];for(let l=1;l<K.length-2;l++)se.push("");se.push(O.totalSinIgv,O.totalConIgv);const Fe=[[],se],Re=[...a,K,...te,...Fe],S=C.aoa_to_sheet(Re);S["!autofilter"]={ref:C.encode_range(C.decode_range(S["!ref"]))},S["!freeze"]={xSplit:0,ySplit:6},S["!cols"]=M;const ae={top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}},$e={font:{bold:!0,sz:11,name:"Arial"},fill:{fgColor:{rgb:"FF4F81BD"}},alignment:{horizontal:"center",vertical:"center"},border:ae},Ae={font:{bold:!0,sz:14,name:"Arial"},alignment:{horizontal:"center",vertical:"center"}},V={font:{sz:10,name:"Arial"},border:ae},W={...V,alignment:{horizontal:"right",vertical:"center"},numFmt:"#,##0.00"};({...V},{...V});const F={font:{bold:!0,sz:11,name:"Arial"},fill:{fgColor:{rgb:"FFD9D9D9"}},border:ae,alignment:{horizontal:"right",vertical:"center"}},Z=C.decode_range(S["!ref"]);for(let l=Z.s.r;l<=Z.e.r;l++)for(let n=Z.s.c;n<=Z.e.c;n++){const i=C.encode_cell({r:l,c:n}),d=S[i];if(d){if(l===0)d.s=Ae;else if(l>=1&&l<=3)d.s={font:{sz:10,name:"Arial"},alignment:{horizontal:"left",vertical:"center"}};else if(l===5)d.s=$e;else if(l>=6&&l<6+te.length){const w=(l-6)%2===0?{...V,fill:{fgColor:{rgb:"FFF2F2F2"}}}:V,I=K[n];I==="Código"?d.s={...w,alignment:{horizontal:"center",vertical:"center"}}:I==="Nombre"?d.s={...w,alignment:{horizontal:"left",vertical:"center"}}:I==="Cantidad"?d.s={...w,alignment:{horizontal:"center",vertical:"center"},numFmt:"0"}:["Precio Lista","Precio Unitario","Subtotal"].includes(I)?d.s={...W,fill:w.fill}:I==="Total c/IGV"?d.s={...W,fill:w.fill,font:{...W.font,bold:!0}}:I.includes("Desc.")?d.s={...W,fill:w.fill,numFmt:"0.00%"}:d.s=w}else if(l===6+te.length+1){const v=K[n];v==="Código"||n===0?d.s={...F,alignment:{horizontal:"left",vertical:"center"},font:{...F.font,bold:!0}}:["Subtotal","Total c/IGV"].includes(v)?d.s={...F,font:{...F.font,bold:!0,sz:12}}:d.s=F}}}const Le="Cotizacion";C.book_append_sheet(t,S,Le);const R=new Date,Te=`${R.getFullYear()}-${String(R.getMonth()+1).padStart(2,"0")}-${String(R.getDate()).padStart(2,"0")}_${String(R.getHours()).padStart(2,"0")}-${String(R.getMinutes()).padStart(2,"0")}`,Ee=`cotizacion_${u.ruc||"sin-ruc"}_${Te}.xlsx`;Ue(t,Ee)};return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx("header",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:be,className:"inline-flex items-center gap-2 bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Volver al Catálogo"]}),e.jsx("h1",{className:"text-2xl font-bold",children:"Nueva Cotización"})]})})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6 border-2 border-blue-100",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm3 2a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z",clipRule:"evenodd"})}),"Datos del Cliente"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["RUC/DNI",!le&&u.ruc&&e.jsx("span",{className:"text-red-500 text-xs ml-2",children:"• Debe ser 8 (DNI) o 11 (RUC) dígitos"})]}),e.jsx("input",{type:"text",className:`w-full border-2 rounded-lg px-3 py-2 focus:ring-2 transition-colors ${!le&&u.ruc?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,placeholder:"Ingrese RUC (11 dígitos) o DNI (8 dígitos)",value:u.ruc,onChange:t=>ee("ruc",t.target.value),maxLength:"11"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Razón Social"}),e.jsx("input",{type:"text",className:"w-full border-2 border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Nombre del cliente o empresa",value:u.nombre,onChange:t=>ee("nombre",t.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Orden de Compra",!re&&u.oc&&e.jsx("span",{className:"text-red-500 text-xs ml-2",children:"• Solo números permitidos"})]}),e.jsx("input",{type:"text",className:`w-full border-2 rounded-lg px-3 py-2 focus:ring-2 transition-colors ${!re&&u.oc?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,placeholder:"Ingrese número de orden de compra",value:u.oc,onChange:t=>ee("oc",t.target.value)})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border-2 border-blue-100 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Seleccionar Productos para Cotización"}),Se&&ce&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded border border-blue-200",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsxs("span",{children:["Selección guardada ",Ge(ce)]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",className:"w-full border-2 border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Buscar productos por código, nombre o descripción...",value:ne,onChange:t=>ye(t.target.value)})}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs("select",{className:"w-full border-2 border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:A,onChange:t=>Ne(t.target.value),children:[e.jsx("option",{value:"TODAS",children:"Todas las líneas"}),[...new Set(J.map(t=>t.linea).filter(Boolean))].sort().map(t=>e.jsx("option",{value:t,children:t},t))]})})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-4 py-3 text-center",children:e.jsx("input",{type:"checkbox",onChange:t=>{if(t.target.checked){const a=he.map(s=>({product:s,quantity:1,manualDiscounts:[0,0]}));D(a)}else D([])},className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})}),e.jsx("th",{scope:"col",className:"px-4 py-3",children:e.jsxs("button",{onClick:()=>P("codigo"),className:"hover:text-blue-600 flex items-center gap-1",children:["Código",h==="codigo"&&e.jsx("span",{children:f==="asc"?"▲":"▼"})]})}),e.jsx("th",{scope:"col",className:"px-4 py-3",children:e.jsxs("button",{onClick:()=>P("nombre"),className:"hover:text-blue-600 flex items-center gap-1",children:["Nombre",h==="nombre"&&e.jsx("span",{children:f==="asc"?"▲":"▼"})]})}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-center",children:e.jsxs("button",{onClick:()=>P("stock"),className:"hover:text-blue-600 flex items-center gap-1",children:["Stock",h==="stock"&&e.jsx("span",{children:f==="asc"?"▲":"▼"})]})}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-center",children:"Cantidad"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:e.jsxs("button",{onClick:()=>P("precio_lista"),className:"hover:text-blue-600 flex items-center gap-1",children:["Precio s/IGV",h==="precio_lista"&&e.jsx("span",{children:f==="asc"?"▲":"▼"})]})}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:e.jsxs("button",{onClick:()=>P("precio_igv"),className:"hover:text-blue-600 flex items-center gap-1",children:["Precio c/IGV",h==="precio_igv"&&e.jsx("span",{children:f==="asc"?"▲":"▼"})]})})]})}),e.jsx("tbody",{children:he.map(t=>{const a=m.find(o=>o.idx===t.idx),s=!!a;return e.jsxs("tr",{className:`border-b hover:bg-gray-50 ${s?"bg-blue-50":""}`,children:[e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:s,onChange:()=>pe(t),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})}),e.jsx("td",{className:"px-4 py-2 font-mono font-medium text-gray-900",children:t.codigo}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("div",{className:"font-medium text-sm leading-tight break-words line-clamp-2 hover:line-clamp-none hover:whitespace-normal transition-all duration-200 cursor-help",title:t.nombre,children:t.nombre})}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${(t.stock||0)>20?"bg-green-100 text-green-800":(t.stock||0)>10?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.stock||0})}),e.jsx("td",{className:"px-4 py-2 text-center",children:s?e.jsx("input",{type:"number",min:"1",className:"w-20 border border-gray-300 rounded-md px-2 py-1 text-center font-mono",value:Math.round(a.quantity),onChange:o=>Me(t.idx,"quantity",o.target.value)}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-4 py-2 text-right font-mono",children:s?b(a.unitPrice):b(t.precio_lista)}),e.jsx("td",{className:"px-4 py-2 text-right font-mono",children:s?b(a.unitPrice*(1+z)):b(t.precio_lista*(1+z))})]},t.idx)})})]})})]}),ue>0&&e.jsx("div",{className:"bg-white border-t border-gray-200 px-4 py-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-700",children:"Mostrar:"}),e.jsxs("select",{value:B,onChange:t=>{Ie(Number(t.target.value)),U(1)},className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]}),e.jsx("span",{className:"text-sm text-gray-600",children:"por página"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>U(t=>Math.max(1,t-1)),disabled:G===1,className:"px-3 py-1 border border-gray-300 rounded text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"‹ Anterior"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Página ",G," de ",Y]}),e.jsx("button",{onClick:()=>U(t=>Math.min(Y,t+1)),disabled:G===Y,className:"px-3 py-1 border border-gray-300 rounded text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Siguiente ›"})]})]})}),m.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6 border-2 border-green-100",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Resumen de Cotización"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-4 py-3",children:e.jsxs("button",{onClick:()=>j("codigo"),className:"hover:text-blue-600 flex items-center gap-1",children:["Código",x==="codigo"&&e.jsx("span",{children:g==="asc"?"▲":"▼"})]})}),e.jsx("th",{scope:"col",className:"px-4 py-3",children:e.jsxs("button",{onClick:()=>j("nombre"),className:"hover:text-blue-600 flex items-center gap-1",children:["Nombre",x==="nombre"&&e.jsx("span",{children:g==="asc"?"▲":"▼"})]})}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-center",children:e.jsxs("button",{onClick:()=>j("cantidad"),className:"hover:text-blue-600 flex items-center gap-1",children:["Cantidad",x==="cantidad"&&e.jsx("span",{children:g==="asc"?"▲":"▼"})]})}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:e.jsxs("button",{onClick:()=>j("precio_base"),className:"hover:text-blue-600 flex items-center gap-1",children:["Precio Base",x==="precio_base"&&e.jsx("span",{children:g==="asc"?"▲":"▼"})]})}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-center",children:"Desc. Cliente (%)"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-center",children:"Desc. Producto (%)"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:e.jsxs("button",{onClick:()=>j("precio_unitario"),className:"hover:text-blue-600 flex items-center gap-1",children:["Precio Unitario",x==="precio_unitario"&&e.jsx("span",{children:g==="asc"?"▲":"▼"})]})}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:e.jsxs("button",{onClick:()=>j("subtotal"),className:"hover:text-blue-600 flex items-center gap-1",children:["Subtotal",x==="subtotal"&&e.jsx("span",{children:g==="asc"?"▲":"▼"})]})}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:e.jsxs("button",{onClick:()=>j("total"),className:"hover:text-blue-600 flex items-center gap-1",children:["Total c/IGV",x==="total"&&e.jsx("span",{children:g==="asc"?"▲":"▼"})]})}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-center",children:"Acción"})]})}),e.jsx("tbody",{children:_e.map(t=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2 font-mono font-medium text-gray-900",children:t.codigo}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("div",{className:"font-medium text-sm leading-tight break-words line-clamp-2 hover:line-clamp-none hover:whitespace-normal transition-all duration-200 cursor-help",title:t.nombre,children:t.nombre})}),e.jsx("td",{className:"px-4 py-2 text-center font-mono",children:Math.round(t.quantity)}),e.jsx("td",{className:"px-4 py-2 text-right font-mono",children:b(t.precio_lista)}),e.jsx("td",{className:"px-4 py-2 text-center font-mono text-sm",children:t.descSuma01?(Math.round(t.descSuma01*100)/100).toFixed(2)+"%":"0.00%"}),e.jsx("td",{className:"px-4 py-2 text-center font-mono text-sm",children:t.descSuma02?(Math.round(t.descSuma02*100)/100).toFixed(2)+"%":"0.00%"}),e.jsx("td",{className:"px-4 py-2 text-right font-mono",children:b(t.unitPrice)}),e.jsx("td",{className:"px-4 py-2 text-right font-mono font-bold text-green-700",children:b(t.totalSinIgv)}),e.jsx("td",{className:"px-4 py-2 text-right font-mono font-bold text-blue-700",children:b(t.totalConIgv)}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx("button",{onClick:()=>pe(t),className:"text-red-500 hover:text-red-700",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})})]},t.idx))})]})})]}),m.length>0&&e.jsx("div",{className:"bg-white border-t border-gray-200 px-4 py-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-700",children:"Mostrar:"}),e.jsxs("select",{value:H,onChange:t=>{Ce(Number(t.target.value)),q(1)},className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]}),e.jsx("span",{className:"text-sm text-gray-600",children:"por página"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>q(t=>Math.max(1,t-1)),disabled:E===1,className:"px-3 py-1 border border-gray-300 rounded text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"‹ Anterior"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Página ",E," de ",X]}),e.jsx("button",{onClick:()=>q(t=>Math.min(X,t+1)),disabled:E===X,className:"px-3 py-1 border border-gray-300 rounded text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Siguiente ›"})]})]})}),m.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-2 border-gray-100",children:[e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold border-b border-gray-300 pb-2",children:[e.jsx("span",{className:"text-gray-800",children:"Subtotal (sin IGV):"}),e.jsx("span",{className:"text-green-600",children:b(O.totalSinIgv)})]}),e.jsxs("div",{className:"flex justify-between items-center text-xl font-bold",children:[e.jsx("span",{className:"text-gray-800",children:"Total (con IGV):"}),e.jsx("span",{className:"text-blue-600",children:b(O.totalConIgv)})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>{D([]),localStorage.removeItem("cotizacion_seleccion"),L(!1),T(null)},className:"flex-1 bg-red-500 hover:bg-red-600 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Limpiar Selección"]}),e.jsxs("button",{onClick:Ve,className:"flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Generar Cotización"]})]})]})]})]})}export{Ze as default};
