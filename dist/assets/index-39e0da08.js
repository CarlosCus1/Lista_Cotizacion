import{r as d,a as me,R as ue}from"./vendor-b1791c80.js";import{u as N,w as oe,F as he}from"./utils-7203dd44.js";(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))f(x);new MutationObserver(x=>{for(const h of x)if(h.type==="childList")for(const p of h.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&f(p)}).observe(document,{childList:!0,subtree:!0});function C(x){const h={};return x.integrity&&(h.integrity=x.integrity),x.referrerPolicy&&(h.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?h.credentials="include":x.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function f(x){if(x.ep)return;x.ep=!0;const h=C(x);fetch(x.href,h)}})();var ie={exports:{}},Z={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ge=d,pe=Symbol.for("react.element"),fe=Symbol.for("react.fragment"),be=Object.prototype.hasOwnProperty,ve=ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ye={key:!0,ref:!0,__self:!0,__source:!0};function ce(m,g,C){var f,x={},h=null,p=null;C!==void 0&&(h=""+C),g.key!==void 0&&(h=""+g.key),g.ref!==void 0&&(p=g.ref);for(f in g)be.call(g,f)&&!ye.hasOwnProperty(f)&&(x[f]=g[f]);if(m&&m.defaultProps)for(f in g=m.defaultProps,g)x[f]===void 0&&(x[f]=g[f]);return{$$typeof:pe,type:m,key:h,ref:p,props:x,_owner:ve.current}}Z.Fragment=fe;Z.jsx=ce;Z.jsxs=ce;ie.exports=Z;var e=ie.exports,ee={},le=me;ee.createRoot=le.createRoot,ee.hydrateRoot=le.hydrateRoot;const je="PEN",ne=.18;function I(m){return isFinite(m)?parseFloat(m.toFixed(2)):0}function E(m){return new Intl.NumberFormat("es-PE",{style:"currency",currency:je}).format(m||0)}function Ne({onBack:m,catalogData:g,descOcultos:C}){const[f,x]=d.useState({ruc:"",nombre:"",oc:""}),[h,p]=d.useState([]),[T,z]=d.useState(""),[B,k]=d.useState("TODAS"),[V,w]=d.useState({});d.useRef(null);const G=d.useMemo(()=>{let t=g;if(B!=="TODAS"&&(t=t.filter(l=>l.linea===B)),T.trim()){const l=T.trim().toLowerCase();t=t.filter(n=>String(n.codigo).toLowerCase().includes(l)||String(n.nombre).toLowerCase().includes(l))}return t},[g,B,T]),j=d.useMemo(()=>h.map(t=>{const l=V[t.idx]||1;let n=t.precioBase;for(const o of C){const L=parseFloat(o)||0;L>0&&(n=I(n*(1-L/100)))}const u=[t.desc1||0,t.desc2||0,t.desc3||0,t.desc4||0,t.descManual1||0,t.descManual2||0,t.descManual3||0].filter(o=>o>0);for(const o of u)n=I(n*(1-o/100));const S=n;let _=1;for(const o of C){const L=parseFloat(o)||0;L>0&&(_*=1-L/100)}const b=I((1-_)*100);let M=1;const Y=[t.desc1||0,t.desc2||0,t.desc3||0,t.desc4||0,t.descManual1||0,t.descManual2||0,t.descManual3||0].filter(o=>o>0);for(const o of Y)M*=1-o/100;const D=I((1-M)*100),H=I(S*l),Q=I(H*(1+ne));return{...t,quantity:l,descSuma01:b,descSuma02:D,precioDescSuma01:I(t.precioBase*(1-b/100)),unitPrice:S,totalSinIgv:H,totalConIgv:Q}}),[h,V,C]),W=d.useMemo(()=>{const t=j.reduce((u,S)=>u+S.totalSinIgv,0),l=I(t),n=I(l*(1+ne));return{subtotal:I(t),totalSinIgv:l,totalConIgv:n}},[j]),$=t=>{p(l=>{if(l.find(u=>u.idx===t.idx)){const u=l.filter(S=>S.idx!==t.idx);return w(S=>{const _={...S};return delete _[t.idx],_}),u}else return w(u=>({...u,[t.idx]:1})),[...l,t]})},K=(t,l)=>{const n=Math.max(1,parseInt(l)||1);w(u=>({...u,[t]:n}))},X=(t,l)=>{x(n=>({...n,[t]:l}))},U=()=>{if(!j.length)return;const t=N.book_new(),l=[["RUC",l.ruc],["Cliente",l.nombre],["OC",l.oc],[]],n=["CÃ³digo","Cantidad","Precio Base","Desc01(suma)","Desc02(suma)","Desc Total Sumado","Total s/IGV","Total c/IGV"],u=j.map(o=>[o.codigo,o.quantity,o.precioBase,o.descSuma01,o.descSuma02,o.descSuma01+o.descSuma02,o.totalSinIgv,o.totalConIgv]),S=[[],["TOTAL s/IGV","","","","",W.totalSinIgv],["TOTAL c/IGV","","","","",W.totalConIgv]],_=[...l,n,...u,...S],b=N.aoa_to_sheet(_);b["!autofilter"]={ref:N.encode_range(N.decode_range(b["!ref"]))},b["!freeze"]={xSplit:0,ySplit:5},b["!cols"]=[{wch:14},{wch:10},{wch:14},{wch:12},{wch:12},{wch:16},{wch:14},{wch:14}];const M=N.decode_range("A5:G5");for(let o=M.s.c;o<=M.e.c;o++){const L=b[N.encode_cell({r:4,c:o})];L&&(L.s={font:{bold:!0},fill:{fgColor:{rgb:"FFE6E6FA"}}})}const Y="Cotizacion";N.book_append_sheet(t,b,Y);const D=new Date,H=`${D.getFullYear()}-${String(D.getMonth()+1).padStart(2,"0")}-${String(D.getDate()).padStart(2,"0")}_${String(D.getHours()).padStart(2,"0")}-${String(D.getMinutes()).padStart(2,"0")}`,Q=`cotizacion_${l.ruc||"sin-ruc"}_${H}.xlsx`;oe(t,Q)};return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx("header",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:m,className:"inline-flex items-center gap-2 bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Volver al CatÃ¡logo"]}),e.jsx("h1",{className:"text-2xl font-bold",children:"Nueva CotizaciÃ³n"})]})})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6 border-2 border-blue-100",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm3 2a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z",clipRule:"evenodd"})}),"Datos del Cliente"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"RUC"}),e.jsx("input",{type:"text",className:"w-full border-2 border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Ingrese RUC",value:f.ruc,onChange:t=>X("ruc",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cliente"}),e.jsx("input",{type:"text",className:"w-full border-2 border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Nombre del cliente",value:f.nombre,onChange:t=>X("nombre",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Orden de Compra"}),e.jsx("input",{type:"text",className:"w-full border-2 border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"OC-001",value:f.oc,onChange:t=>X("oc",t.target.value)})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border-2 border-blue-100 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm3 2a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z",clipRule:"evenodd"})}),"CotizaciÃ³n - SelecciÃ³n y Cantidades (",j.length," productos seleccionados)"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",className:"w-full border-2 border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Buscar producto por cÃ³digo o nombre...",value:T,onChange:t=>z(t.target.value)})}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs("select",{className:"w-full border-2 border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:B,onChange:t=>k(t.target.value),children:[e.jsx("option",{value:"TODAS",children:"Todas las lÃ­neas"}),[...new Set(g.map(t=>t.linea).filter(Boolean))].sort().map(t=>e.jsx("option",{value:t,children:t},t))]})})]})]}),e.jsx("div",{className:"max-h-[600px] overflow-y-auto",children:G.length===0?e.jsxs("div",{className:"p-12 text-center text-gray-500",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No se encontraron productos"}),e.jsx("p",{className:"text-sm",children:"Ajusta los filtros de bÃºsqueda"})]}):e.jsxs("div",{className:"bg-white",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-800 to-blue-900 text-white px-4 py-3 sticky top-0 z-10 shadow-md",children:e.jsxs("div",{className:"grid grid-cols-[50px_100px_1fr_80px_100px_100px_100px_100px_50px] gap-2 text-xs font-bold",children:[e.jsx("div",{className:"text-center",children:"Sel"}),e.jsx("div",{className:"text-center",children:"CÃ³digo"}),e.jsx("div",{children:"Nombre"}),e.jsx("div",{className:"text-center",children:"Cant"}),e.jsx("div",{className:"text-right",children:"Precio Base"}),e.jsx("div",{className:"text-right",children:"Desc Suma 01"}),e.jsx("div",{className:"text-right",children:"Desc Suma 02"}),e.jsx("div",{className:"text-right",children:"Total s/IGV"}),e.jsx("div",{className:"text-right",children:"Total c/IGV"}),e.jsx("div",{})]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:G.map(t=>{const l=h.find(u=>u.idx===t.idx),n=j.find(u=>u.idx===t.idx);return e.jsx("div",{className:`px-4 py-3 transition-colors ${l?"bg-blue-50 border-l-4 border-blue-500":"hover:bg-gray-50"}`,children:e.jsxs("div",{className:"grid grid-cols-[50px_100px_1fr_80px_100px_100px_100px_100px_50px] gap-2 items-center text-sm",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("input",{type:"checkbox",checked:l||!1,onChange:()=>$(t),className:"w-5 h-5 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"})}),e.jsx("div",{className:"font-mono font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded text-center",children:t.codigo}),e.jsx("div",{className:"font-medium text-gray-800 truncate",title:t.nombre,children:t.nombre}),e.jsx("div",{className:"flex justify-center",children:l?e.jsx("input",{type:"number",min:"1",className:"w-16 border-2 border-yellow-400 rounded px-2 py-1 text-center text-sm font-semibold bg-yellow-50 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500",value:(n==null?void 0:n.quantity)||1,onChange:u=>K(t.idx,u.target.value)}):e.jsx("span",{className:"text-gray-400 text-xs",children:"-"})}),e.jsx("div",{className:"text-right tabular-nums font-mono text-gray-600",children:E(t.precioBase)}),l?e.jsxs("div",{className:"text-right tabular-nums font-mono text-green-600 font-semibold",children:[E(n.precioDescSuma01),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["(",n.descSuma01.toFixed(2),"%)"]})]}):e.jsx("div",{className:"text-right text-gray-400 text-xs",children:"-"}),l?e.jsxs("div",{className:"text-right tabular-nums font-mono text-blue-600 font-bold",children:[E(n.unitPrice),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["(",n.descSuma02.toFixed(2),"%)"]})]}):e.jsx("div",{className:"text-right text-gray-400 text-xs",children:"-"}),l?e.jsx("div",{className:"text-right tabular-nums font-mono text-green-700 font-semibold",children:E(n.totalSinIgv)}):e.jsx("div",{className:"text-right text-gray-400 text-xs",children:"-"}),l?e.jsx("div",{className:"text-right tabular-nums font-mono text-blue-700 font-bold",children:E(n.totalConIgv)}):e.jsx("div",{className:"text-right text-gray-400 text-xs",children:"-"}),e.jsx("div",{className:"flex justify-center",children:l&&e.jsx("button",{onClick:()=>$(t),className:"w-6 h-6 bg-red-100 hover:bg-red-200 text-red-600 rounded-full flex items-center justify-center transition-colors",title:"Remover de cotizaciÃ³n",children:e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})},t.idx)})})]})}),j.length>0&&e.jsxs("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:[e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold border-b border-gray-300 pb-2",children:[e.jsx("span",{className:"text-gray-800",children:"Total s/IGV:"}),e.jsx("span",{className:"text-green-600",children:E(W.totalSinIgv)})]}),e.jsxs("div",{className:"flex justify-between items-center text-xl font-bold",children:[e.jsx("span",{className:"text-gray-800",children:"Total c/IGV:"}),e.jsx("span",{className:"text-blue-600",children:E(W.totalConIgv)})]})]}),e.jsxs("button",{onClick:U,className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Exportar CotizaciÃ³n XLSX"]})]})]})]})]})}const we="PEN",Se=.18,Ce=52;function P(m){return isFinite(m)?parseFloat(m.toFixed(2)):0}function J(m){return new Intl.NumberFormat("es-PE",{style:"currency",currency:we}).format(m||0)}function Me(){const[m,g]=d.useState([]),[C,f]=d.useState(!0),[x,h]=d.useState(null),[p,T]=d.useState("TODAS"),[z,B]=d.useState(""),[k,V]=d.useState([0,0,0,0]),[w,G]=d.useState(1),[j,W]=d.useState("codigo"),[$,K]=d.useState("asc"),[X,U]=d.useState(!1),[t,l]=d.useState(null),[n,u]=d.useState("catalog"),S=d.useRef(null),_=d.useMemo(()=>{const s=new Set(m.map(i=>i.linea).filter(Boolean));return Array.from(s).sort((i,r)=>i.localeCompare(r,void 0,{sensitivity:"base"}))},[m]);d.useEffect(()=>{let s=!1;async function i(){try{f(!0);const r=await fetch("/catalogo.json",{cache:"no-store"});if(!r.ok)throw new Error(`HTTP ${r.status}`);const a=await r.json();if(s)return;const c=(Array.isArray(a)?a:[]).map((y,R)=>({idx:R,codigo:y.codigo??"",linea:y.linea??"",nombre:y.nombre??"",precioBase:parseFloat(String(y.precio).replace(/[^\d.-]/g,""))||0,desc1:parseFloat(String(y.desc1).replace(/[^\d.-]/g,""))||0,desc2:parseFloat(String(y.desc2).replace(/[^\d.-]/g,""))||0,desc3:parseFloat(String(y.desc3).replace(/[^\d.-]/g,""))||0,desc4:parseFloat(String(y.desc4).replace(/[^\d.-]/g,""))||0,descManual1:0,descManual2:0,descManual3:0}));g(c),h(null)}catch(r){s||h(String(r))}finally{s||f(!1)}}return i(),Q(),()=>{s=!0}},[]);const b=d.useMemo(()=>{let s=m;if(p!=="TODAS"&&(s=s.filter(r=>r.linea===p)),z.trim()){const r=z.trim().toLowerCase();s=s.filter(a=>String(a.codigo).toLowerCase().includes(r)||String(a.nombre).toLowerCase().includes(r))}return[...s].sort((r,a)=>{let c=0;return j==="codigo"?c=String(r.codigo).localeCompare(String(a.codigo),void 0,{numeric:!0,sensitivity:"base"}):j==="linea"&&(c=String(r.linea).localeCompare(String(a.linea),void 0,{sensitivity:"base"})),$==="asc"?c:-c}).map(r=>{let a=r.precioBase;const c=k.filter(F=>parseFloat(String(F).replace(/[^\d.-]/g,""))>0);for(const F of c)a=P(a*(1-parseFloat(F)/100));const y=[r.desc1||0,r.desc2||0,r.desc3||0,r.desc4||0,r.descManual1||0,r.descManual2||0,r.descManual3||0].filter(F=>F>0);for(const F of y)a=P(a*(1-F/100));const R=a,O=P(R*(1+Se));return{...r,neto:R,final:O}})},[m,p,z,k,j,$]);function M(s,i,r){g(a=>{const c=[...a],y=b[s];if(!y)return a;const R=m.findIndex(O=>O.idx===y.idx);return R===-1?a:(c[R]={...c[R],[i]:parseFloat(String(r).replace(/[^\d.-]/g,""))||0},c)})}function Y(s){j===s?K(i=>i==="asc"?"desc":"asc"):(W(s),K("asc"))}function D(s,i){V(r=>{const a=r.slice();return a[s]=Math.max(0,parseFloat(String(i).replace(/[^\d.-]/g,""))||0),a})}function H(){const s={descOcultos:k,timestamp:Date.now()};localStorage.setItem("precios_descuentos",JSON.stringify(s)),U(!0),l(new Date)}function Q(){try{const s=localStorage.getItem("precios_descuentos");if(s){const{descOcultos:i,timestamp:r}=JSON.parse(s),a=30*24*60*60*1e3;Date.now()-r<a&&(V(i),U(!0),l(new Date(r)))}}catch(s){console.warn("Error loading saved discounts:",s)}}function o(){V([0,0,0,0]),localStorage.removeItem("precios_descuentos"),U(!1),l(null)}function L(s){if(!s)return"";const r=new Date-s,a=Math.floor(r/(1e3*60)),c=Math.floor(r/(1e3*60*60)),y=Math.floor(r/(1e3*60*60*24));return a<60?`hace ${a} min`:c<24?`hace ${c}h`:`hace ${y} dÃ­as`}function te(){if(!b.length)return;const s=N.book_new(),i=p==="TODAS"?[...new Set(b.map(O=>O.linea))].filter(Boolean):[p];for(const O of i){const F=b.filter(v=>v.linea===O);if(F.length===0)continue;const se=["cÃ³digo","lÃ­nea","nombre","precioBase","descOculto1","descOculto2","descOculto3","descOculto4","descManual1","descManual2","neto","+IGV","final"],re=[se,...F.map(v=>[v.codigo??"",v.linea??"",v.nombre??"",v.precioBase,...k.map(q=>parseFloat(String(q).replace(/[^\d.-]/g,""))||0),v.descManual1,v.descManual2,v.neto,v.final,v.final])],A=N.aoa_to_sheet(re);A["!autofilter"]={ref:N.encode_range(N.decode_range(A["!ref"]))},A["!cols"]=[{wch:14},{wch:16},{wch:48},{wch:14},{wch:12},{wch:12},{wch:12},{wch:12},{wch:14},{wch:14},{wch:14},{wch:14},{wch:14}],A["!freeze"]={xSplit:0,ySplit:1};const de=new Set([3,10,11,12]);for(let v=0;v<se.length;v++){const q=A[N.encode_cell({r:0,c:v})];q&&(q.s={font:{bold:!0}})}for(let v=1;v<re.length;v++)for(const q of de){const ae=A[N.encode_cell({r:v,c:q})];ae&&(ae.z="#,##0.00")}const xe=(O||"Sheet").slice(0,31).replace(/[/\\?*[\]:]/g,"_");N.book_append_sheet(s,A,xe)}const r=new Date,a=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}_${String(r.getHours()).padStart(2,"0")}-${String(r.getMinutes()).padStart(2,"0")}`,c=p==="TODAS"?"TODAS":p,y=k.map(O=>String(parseFloat(String(O).replace(/[^\d.-]/g,""))||0).replace(/\./g,"-")).join("-"),R=`precios_${c.toLowerCase()}-descuentos${y}_${a}.xlsx`;oe(s,R)}return n==="quotation"?e.jsx(Ne,{onBack:()=>u("catalog"),catalogData:m,descOcultos:k}):e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx("header",{className:"bg-white shadow-sm border-b",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsxs("div",{className:"bg-gray-100 p-1 rounded-lg flex",children:[e.jsx("button",{onClick:()=>u("catalog"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${n==="catalog"?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:text-gray-900"}`,children:"ðŸ“‹ CatÃ¡logo"}),e.jsx("button",{onClick:()=>u("quotation"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${n==="quotation"?"bg-purple-600 text-white shadow-md":"text-gray-600 hover:text-gray-900"}`,children:"ðŸ§¾ CotizaciÃ³n"})]})}),e.jsxs("div",{className:"block md:hidden space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1",children:"LÃ­nea"}),e.jsxs("select",{className:"border border-gray-300 rounded-md px-2 py-2 bg-white text-sm",value:p,onChange:s=>T(s.target.value),children:[e.jsx("option",{value:"TODAS",children:"TODAS"}),_.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1",children:"Buscar"}),e.jsx("input",{type:"text",className:"border border-gray-300 rounded-md px-2 py-2 text-sm",placeholder:"cÃ³digo o nombre",value:z,onChange:s=>B(s.target.value)})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700 mb-1",children:"Desc. ocultos (%)"}),e.jsx("div",{className:"grid grid-cols-4 gap-1",children:[0,1,2,3].map(s=>e.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",className:"border border-gray-300 rounded px-1 py-1 text-xs text-center",placeholder:`v${s+1}`,value:k[s],onChange:i=>D(s,i.target.value)},s))})]}),e.jsx("button",{onClick:te,className:"w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md font-medium text-sm",children:"Descargar XLSX"})]}),e.jsxs("div",{className:"hidden md:flex md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex gap-4 flex-1",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"LÃ­nea"}),e.jsxs("select",{className:"border border-gray-300 rounded-md px-3 py-2 bg-white",value:p,onChange:s=>T(s.target.value),children:[e.jsx("option",{value:"TODAS",children:"TODAS"}),_.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1",children:"Buscar"}),e.jsx("input",{type:"text",className:"border border-gray-300 rounded-md px-3 py-2",placeholder:"cÃ³digo o nombre",value:z,onChange:s=>B(s.target.value)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 mb-1",children:"Desc. ocultos"}),e.jsx("div",{className:"grid grid-cols-4 gap-1",children:[0,1,2,3].map(s=>e.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",className:"border border-gray-300 rounded px-2 py-1 text-sm text-center",placeholder:`v${s+1}`,value:k[s],onChange:i=>D(s,i.target.value)},s))}),e.jsxs("div",{className:"flex items-center justify-between gap-2 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:H,className:"inline-flex items-center gap-2 bg-green-600 hover:bg-green-700 active:bg-green-800 text-white px-3 py-1.5 rounded-md text-xs font-medium transition-colors shadow-sm",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Guardar"]}),e.jsxs("button",{onClick:o,className:"inline-flex items-center gap-2 bg-red-600 hover:bg-red-700 active:bg-red-800 text-white px-3 py-1.5 rounded-md text-xs font-medium transition-colors shadow-sm",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Limpiar"]})]}),X&&t&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-green-600 bg-green-50 px-2 py-1 rounded border border-green-200",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsxs("span",{children:["Guardado ",L(t)]})]})]})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("button",{onClick:te,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium",children:"Descargar XLSX"})})]})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-6",children:[x&&e.jsx("div",{className:"mb-4 rounded-lg border border-red-200 bg-red-50 p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-red-600 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),e.jsx("span",{className:"font-medium text-sm sm:text-base",children:"Error al cargar catÃ¡logo:"}),e.jsx("span",{className:"text-sm sm:text-base",children:String(x)})]})}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:[e.jsx("div",{className:"relative",children:b.length===0&&!C?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500",children:[e.jsx("svg",{className:"h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-lg font-medium",children:"No se encontraron productos."}),e.jsx("p",{className:"text-sm",children:"Intenta ajustar tus filtros o bÃºsqueda."})]}):e.jsx(e.Fragment,{children:e.jsx(he,{ref:S,height:Math.min(window.innerHeight-220,800),itemCount:b.length+1,itemSize:Ce,width:"100%",children:({index:s,style:i})=>{if(s===0)return e.jsxs("div",{style:i,className:"hidden sm:flex sticky top-0 z-10 bg-blue-800 text-white font-bold text-sm shadow-md border-b-2 border-blue-600",children:[e.jsx("div",{className:"w-24 flex-shrink-0 px-3 py-3 text-left border-r border-blue-600",style:{minWidth:"96px"},children:e.jsxs("button",{className:"hover:text-blue-200 transition-colors text-sm font-bold",onClick:()=>Y("codigo"),title:"Ordenar por cÃ³digo","aria-label":`Ordenar por cÃ³digo ${j==="codigo"?$==="asc"?"ascendente":"descendente":""}`,children:["cÃ³digo",j==="codigo"&&e.jsx("span",{className:"ml-1",children:$==="asc"?"â–²":"â–¼"})]})}),e.jsx("div",{className:"flex-[0.8] min-w-0 px-3 py-3 border-r border-blue-600",style:{minWidth:"200px"},children:"nombre"}),e.jsx("div",{className:"w-28 flex-shrink-0 px-3 py-3 text-right border-r border-blue-600",style:{minWidth:"112px"},children:"precio base"}),e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 text-right border-r border-blue-600",style:{minWidth:"80px"},children:"desc1"}),e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 text-right border-r border-blue-600",style:{minWidth:"80px"},children:"desc2"}),e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 text-right border-r border-blue-600",style:{minWidth:"80px"},children:"desc3"}),e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 text-right border-r border-blue-600",style:{minWidth:"80px"},children:"desc4"}),e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 text-center border-r border-blue-600",style:{minWidth:"80px"},children:"Especial 1"}),w>=2&&e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 text-center border-r border-blue-600",style:{minWidth:"80px"},children:"Especial 2"}),w>=3&&e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 text-center border-r border-blue-600",style:{minWidth:"80px"},children:"Especial 3"}),e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 text-center border-r border-blue-600",style:{minWidth:"80px"},children:e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[w>1&&e.jsx("button",{onClick:()=>G(Math.max(1,w-1)),className:"w-6 h-6 bg-red-500 hover:bg-red-600 text-white rounded text-xs font-medium flex items-center justify-center transition-colors",title:"Quitar descuento manual",children:"âˆ’"}),w<3&&e.jsx("button",{onClick:()=>G(Math.min(3,w+1)),className:"w-6 h-6 bg-green-500 hover:bg-green-600 text-white rounded text-xs font-medium flex items-center justify-center transition-colors",title:"Agregar descuento manual",children:"+"})]})}),e.jsx("div",{className:"w-28 flex-shrink-0 px-3 py-3 text-right border-r border-blue-600",style:{minWidth:"112px"},children:"s/igv"}),e.jsx("div",{className:"w-28 flex-shrink-0 px-3 py-3 text-right",style:{minWidth:"112px"},children:"c/igv"})]});const r=s-1,a=b[r];return a?e.jsxs("div",{style:i,className:"border-b border-gray-200 hover:bg-gray-50",children:[e.jsxs("div",{className:"hidden sm:flex w-full",style:{minWidth:`${800+w*80}px`},children:[e.jsx("div",{className:"w-24 flex-shrink-0 px-3 py-3 truncate font-mono text-sm border-r border-gray-200",children:a.codigo}),e.jsx("div",{className:"flex-[0.8] min-w-0 px-3 py-3 border-r border-gray-200",children:e.jsx("div",{className:"font-medium text-sm leading-tight break-words line-clamp-2 hover:line-clamp-none hover:whitespace-normal transition-all duration-200 cursor-help",title:a.nombre,children:a.nombre})}),e.jsx("div",{className:"w-28 flex-shrink-0 px-3 py-3 text-right tabular-nums font-mono text-sm border-r border-gray-200",children:J(a.precioBase)}),e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 text-right tabular-nums font-mono text-gray-500 text-sm border-r border-gray-200",children:P(a.desc1).toFixed(2)}),e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 text-right tabular-nums font-mono text-gray-500 text-sm border-r border-gray-200",children:P(a.desc2).toFixed(2)}),e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 text-right tabular-nums font-mono text-gray-500 text-sm border-r border-gray-200",children:P(a.desc3).toFixed(2)}),e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 text-right tabular-nums font-mono text-gray-500 text-sm border-r border-gray-200",children:P(a.desc4).toFixed(2)}),e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 flex justify-center border-r border-gray-200",children:e.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",className:"w-16 border border-gray-300 rounded px-2 py-1 text-right tabular-nums text-sm",value:a.descManual1,onChange:c=>M(r,"descManual1",c.target.value)})}),w>=2&&e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 flex justify-center border-r border-gray-200",children:e.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",className:"w-16 border border-gray-300 rounded px-2 py-1 text-right tabular-nums text-sm",value:a.descManual2,onChange:c=>M(r,"descManual2",c.target.value)})}),w>=3&&e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 flex justify-center border-r border-gray-200",children:e.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",className:"w-16 border border-gray-300 rounded px-2 py-1 text-right tabular-nums text-sm",value:a.descManual3||0,onChange:c=>M(r,"descManual3",c.target.value)})}),e.jsx("div",{className:"w-20 flex-shrink-0 px-3 py-3 border-r border-gray-200"}),e.jsx("div",{className:"w-28 flex-shrink-0 px-3 py-3 text-right tabular-nums font-mono text-green-700 text-sm border-r border-gray-200",children:J(a.neto)}),e.jsx("div",{className:"w-28 flex-shrink-0 px-3 py-3 text-right tabular-nums font-mono font-bold text-blue-700 text-sm",children:J(a.final)})]}),e.jsxs("div",{className:"flex sm:hidden items-start w-full",children:[e.jsx("div",{className:"w-20 flex-shrink-0 px-2 py-2 font-mono text-xs font-bold text-blue-600 bg-blue-50 border-r border-gray-200",children:a.codigo}),e.jsxs("div",{className:"flex-1 min-w-0 px-2 py-2 border-r border-gray-200",children:[e.jsx("div",{className:"font-medium text-xs leading-tight mb-1 break-words line-clamp-2",title:a.nombre,children:a.nombre}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-right tabular-nums font-mono font-bold text-blue-700 text-sm bg-blue-100 px-2 py-1 rounded border-2 border-blue-300",children:J(a.final)}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",placeholder:"D1",className:"w-10 border border-yellow-400 rounded px-1 py-0.5 text-right tabular-nums text-xs bg-yellow-50",value:a.descManual1,onChange:c=>M(r,"descManual1",c.target.value)}),e.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",placeholder:"D2",className:"w-10 border border-yellow-400 rounded px-1 py-0.5 text-right tabular-nums text-xs bg-yellow-50",value:a.descManual2,onChange:c=>M(r,"descManual2",c.target.value)})]})]})]})]})]}):e.jsxs("div",{style:i,className:"flex items-center px-4 py-3 text-sm text-gray-500 bg-gray-50 border-b border-gray-200",children:[e.jsxs("svg",{className:"mr-2 h-4 w-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Cargando..."]})}})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-3 sm:px-4 py-3 sm:py-4 bg-gray-50 border-t border-gray-200 text-sm",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4 text-gray-600 mb-3 sm:mb-0",children:[C?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("svg",{className:"h-4 w-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Cargando..."})]}):e.jsxs("span",{className:"font-medium text-xs sm:text-sm",children:[b.length," registros"]}),p!=="TODAS"&&e.jsxs("span",{className:"text-gray-500 text-xs sm:text-sm",children:["â€¢ LÃ­nea: ",e.jsx("span",{className:"font-medium text-gray-700",children:p})]}),z&&e.jsxs("span",{className:"text-gray-500 text-xs sm:text-sm",children:["â€¢ BÃºsqueda: ",e.jsxs("span",{className:"font-medium text-gray-700",children:['"',z,'"']})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-600 text-xs sm:text-sm",children:"Total visible:"}),e.jsx("span",{className:"font-bold text-base sm:text-lg text-blue-700",children:J(b.reduce((s,i)=>s+(i.final||0),0))})]})]})]})]})]})}ee.createRoot(document.getElementById("root")).render(e.jsx(ue.StrictMode,{children:e.jsx(Me,{})}));
